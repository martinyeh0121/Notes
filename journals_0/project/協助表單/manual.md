



## 流程

* slack workflow 取得 google form 連結 -> 
* google form 填寫 -> 
* google sheet 儲存回覆 -> 
* n8n 查看 sheet 發送 slack 通知

https://n8n.mobagel.com/workflow/VPOY5PZxUaa1SO6R


## **操作說明!!!**

1. 為避免使用太多 google API 配額（google API 配額超限），希望：

✅ **由管理者手動清理 Google 試算表中的資料** (右鍵 -> 刪除列)
❌ 而不是寫自動刪除程式，避免過度自動化導致 API 限制

2. 以 google sheet 內容為主

---

### ✅ n8n 擴展：

* 設計 Google 表單 並連結 Google 試算表
* n8n 管理 Google 試算表

1. **建立 Google 表單** → 回覆自動進入 Google 試算表。
2. **不刪表單回應，只清理試算表的資料列**：

   * 管理者進入 Google 試算表
   * 手動刪除特定回應資料（例如舊的、不需要的回應）
3. 這樣不會觸發 Apps Script 或 API，也不會影響 Google 表單中回應的保存。
4. **表單依然可以繼續收新資料**，不影響運作。

---

### 🔐 管理者操作建議

你可以在 Google 試算表中：

* **凍結第一列**（方便標題清楚）
* 管理者定期清理舊資料（例如每週或每月刪除前 N 筆）
* 或用「篩選條件」找出不需要的回應，快速手動刪除

✅ 這些都是「前端操作」，完全不會消耗 Google Apps Script 的配額（Trigger、Quota）或導致 API 上限。

---

### ⚠️ 提醒

* Google 表單「回應」刪除會讓那筆資料永久移除，**建議只刪試算表資料，不動表單回應本體**。
* 這樣你未來若要查歷史紀錄，還可以從表單後台重新匯出。

---

### 📦 小總結：

| 操作方式              | 是否消耗 API 配額 | 建議             |
| ----------------- | ------------------ | -------------- |
| 自動 Apps Script 清理 | ✅ 會                | ❌ 除非有需要        |
| 手動刪除試算表資料         | ❌ 不會               | ✅ 安全可靠         |
| 刪除 google form 回應     | ❌ 不會               | ⚠️ 不會影響 google sheet API 消耗 |
| 重新匯出表單資料          | ❌ 不會               | ✅ 可做定期備份       |

---

需要我幫你設計一個「清理按鈕」給管理者一鍵清空試算表內容（只清除內容，不觸動 API）嗎？或者你們目前就是單純用 Google 試算表開啟後手動刪除資料列呢？



## 測試

| 測試編號 | Google Sheet 操作 | Google Form 操作 |結果| Google Sheet 變化敘述 | Sheet API 變化類型 | Null 欄位狀態 | 訊息傳送 |
|----------|------------------------|------------------------------|---|-------------------------|--------------------------|------------------------|------------|
| 1 | 刪除最後 4 列 | 加入 1 列（下一循環） || 加在第 1 行 | 新增 (added) | 無缺漏 (no appear) | ✅ 傳送（1） |
| 2 | 無 | 刪除 1 列，加入 1 列 || 新增 1 行 | 新增 (added) | 無缺漏 (no appear) | ✅ 傳送（1） |
| 3 | 刪除最後 1 列 | 加入 1 列 || 加在第 1 行 | 更新 (updated) | 無缺漏 (no appear) | ✅ 傳送（1） |
| 4 | 刪除最後 1 列 | 無 || 少了第 1 行 | 無變化 (---) | 無缺漏 (no appear) | ❌ 未傳送（0） |

 
結論：

* Google Sheet 的刪除操作不會觸發通知事件，但 n8n 會記錄當前狀態，導致 added / updated 的判斷不總是準確。

* Google Form 與 Google Sheet 僅在新增資料時同步，刪除操作為獨立事件，無雙向影響。

* 由於 Sheet API 是透過前後狀態快照來比對變化，為避免資源消耗或延遲，建議定期清理 Sheet 的歷史紀錄。

