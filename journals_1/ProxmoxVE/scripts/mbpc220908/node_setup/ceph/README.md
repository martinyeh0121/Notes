# Ceph 環境重建工具

此目錄包含用於 Ceph 環境重建的腳本工具。
**!!! 不包含 osd 資料備分 / 導出處理**

## rebuildpve.sh

這是一個暴力重建 Ceph kernel 的工具腳本，可用於不同版本的 kernel 重建。

### 功能特點

- **!!! 不包含 osd 資料備分 / 導出處理**
- 務必移除無用容器殘留 (`./移除殘留相關.sh`)
- 預設為 squid -> reef
- 強制重建至 Reef 版本（從 Squid 19.2 降版）
- PVE 系統設定會自動調整相容性（通過 apt install proxmox-ve）
- 預設只清理 Ceph 相關設定
- 保留 PVE 系統設定
- 自動移除 Ceph kernel 模組
- 自動調整 APT Repository

### 清理範圍

預設清理項目：
- Ceph 相關設定 (`/etc/ceph/`)
- Ceph 資料目錄 (`/var/lib/ceph/`)
- Ceph 相關套件
- Ceph kernel 模組

### 使用須知

1. 執行前必須備份重要資料
2. 需要清理其他設定時，請自行修改腳本
3. 不保證資料完全可復原，請自行承擔風險
4. 建議在測試環境先行驗證
5. 預設針對 Squid (19.2) 版本進行測試

### 執行方式

```bash
# 1. 建議先備份前端資料
cp -r ./etc/pve ~/backup/$(date +%Y%m%d)/

# 2. 執行重建腳本
bash rebuildpve.sh
```

## 注意事項

- 此工具為暴力重建工具，執行前請確認已完整備份
- 如需保留其他設定，請先自行備份相關檔案
- 腳本執行過程中會要求確認，可隨時中斷操作
- 建議在執行前詳細閱讀腳本內容，了解具體操作步驟